/* ============================================================
   TrackStudio Component Styles
   Modern overrides for every UI component.
   Load LAST so these rules win over legacy selectors.
   ============================================================ */


/* ── App shell ────────────────────────────────────────────── */

BODY.ts-app {
    background-color: var(--ts-bg);
    margin: 0;
    padding: var(--ts-space-4);
}

.ts-app-shell {
    max-width: 1680px;
    margin: 0 auto;
}


/* ── Login page ───────────────────────────────────────────── */

BODY.ts-login-page {
    background: var(--ts-primary);
    margin: 0;
    padding: var(--ts-space-4);
}

.ts-login-shell {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--ts-space-4);
    box-sizing: border-box;
}

.ts-login-card {
    background-color: var(--ts-surface);
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-md);
    box-shadow: var(--ts-shadow-xl);
    padding: 8px 8px 0 8px;
}

.ts-login-brand {
    text-align: center;
    padding: 16px 12px 8px 12px;
}

.ts-login-card .blueborder {
    border: none;
    border-top: 1px solid var(--ts-border);
}

.ts-login-footer {
    margin-top: var(--ts-space-4);
    text-align: center;
    color: rgba(255,255,255,0.55);
    font-size: var(--ts-font-xs);
}
.ts-login-footer a {
    color: rgba(255,255,255,0.7);
    font-size: var(--ts-font-xs);
}
.ts-login-footer a:hover {
    color: #ffffff;
}

.ts-login-error {
    display: block;
    margin-bottom: var(--ts-space-2);
    color: var(--ts-danger);
    font-weight: 500;
}

TABLE.login TH {
    text-align: left;
}
TABLE.login LABEL {
    color: var(--ts-text-muted);
    font-weight: 600;
    font-size: var(--ts-font-base);
}
TABLE.login TD {
    padding: var(--ts-space-2) var(--ts-space-1);
}
TABLE.login TD.controls {
    text-align: left;
    padding-top: var(--ts-space-3);
}
TABLE.login LABEL.secondary {
    color: var(--ts-text);
    font-weight: 500;
}

INPUT.reallyBig {
    font-size: var(--ts-font-lg);
    font-weight: normal;
    height: 42px;
    width: 100%;
    border-radius: var(--ts-radius-sm);
    border: 1px solid var(--ts-border-strong);
    padding: var(--ts-space-2) var(--ts-space-3);
}
INPUT.reallyBig:focus {
    border-color: var(--ts-primary-light);
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.15);
}


/* ── Brand ────────────────────────────────────────────────── */

.ts-brand-logo,
.ts-brand-inline {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-family: var(--ts-font-family);
    font-weight: 700;
    letter-spacing: 0.2px;
}

.ts-brand-mark {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 34px;
    height: 34px;
    font-size: 0.85rem;
    font-weight: 700;
    color: #ffffff;
    background-color: var(--ts-primary);
    border-radius: var(--ts-radius-sm);
}

.ts-brand-name {
    font-size: 20px;
    line-height: 24px;
    color: var(--ts-text);
}
.ts-brand-name span {
    color: var(--ts-primary-light);
}

.ts-brand-subtitle {
    margin-top: 4px;
    font-size: var(--ts-font-xs);
    letter-spacing: 1.2px;
    text-transform: uppercase;
    color: var(--ts-text-muted);
}

.ts-brand-inline {
    padding-top: 5px;
    padding-bottom: 5px;
}
.ts-brand-inline .ts-brand-name {
    font-size: 18px;
    line-height: 22px;
}


/* ── Header bar (div.login in TaskHeader/UserHeader) ──────── */

div.login {
    font-size: var(--ts-font-sm);
    color: var(--ts-text);
    background-color: var(--ts-surface);
    padding: var(--ts-space-2) var(--ts-space-3);
    border-bottom: 1px solid var(--ts-border);
}
div.login A {
    font-size: var(--ts-font-sm);
    color: var(--ts-primary-light);
    text-decoration: none;
}
div.login A:hover {
    color: var(--ts-primary);
}

.ts-header-main {
    display: grid;
    grid-template-columns: minmax(220px, 1fr) minmax(250px, 430px) minmax(260px, 1fr);
    align-items: center;
    gap: var(--ts-space-2);
}

.ts-header-brand-link {
    display: inline-flex;
    text-decoration: none !important;
    color: inherit !important;
}

.ts-header-main__brand {
    justify-self: start;
    min-width: 0;
}

.ts-header-main__search {
    justify-self: center;
    width: 100%;
    max-width: 430px;
}

.ts-header-search-form {
    margin: 0;
    width: 100%;
}

.ts-header-main__search input.form-autocomplete {
    width: 100%;
    box-sizing: border-box;
}

.ts-header-main__user {
    justify-self: end;
    min-width: 0;
    width: 100%;
    display: flex;
    justify-content: flex-end;
}

.ts-header-user-row {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: var(--ts-space-2);
    padding: 0;
    flex-wrap: wrap;
}

.ts-header-user-info {
    display: inline-flex;
    align-items: center;
    gap: var(--ts-space-1);
    font-size: var(--ts-font-xs);
    color: var(--ts-text-muted);
    min-width: 0;
    max-width: 100%;
    justify-content: flex-end;
    flex-wrap: wrap;
}

.ts-header-user-link {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: var(--ts-font-xs) !important;
    font-weight: 600;
    color: var(--ts-text) !important;
    text-decoration: none;
}
.ts-header-user-link:hover {
    color: var(--ts-primary) !important;
}

.ts-header-user-sep {
    color: var(--ts-border-strong);
    font-size: var(--ts-font-sm);
}

.ts-header-user-roles {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: var(--ts-font-xs);
    color: var(--ts-text-muted);
    font-style: normal;
    border: 1px solid var(--ts-border);
    background: var(--ts-surface-muted);
    border-radius: 999px;
    padding: 2px 8px;
    line-height: 1.3;
    max-width: 36ch;
    white-space: normal;
    overflow-wrap: anywhere;
}

.ts-header-user-link img,
.ts-header-user-roles img {
    width: 14px;
    height: 14px;
    object-fit: contain;
    flex: 0 0 auto;
}

.ts-header-action-link {
    display: inline-block;
    font-size: var(--ts-font-xs) !important;
    font-weight: 600;
    color: var(--ts-primary) !important;
    text-decoration: none;
    padding: 2px 10px;
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    transition: all var(--ts-transition);
    background: var(--ts-surface);
    line-height: 1.6;
}
.ts-header-action-link:hover {
    background: var(--ts-primary-soft);
    border-color: var(--ts-primary);
    color: var(--ts-primary-strong) !important;
}

@media (max-width: 1200px) {
    .ts-header-main {
        grid-template-columns: minmax(180px, 1fr) minmax(230px, 380px) minmax(220px, 1fr);
    }
    .ts-header-user-roles {
        max-width: 26ch;
    }
}

@media (max-width: 980px) {
    .ts-header-main {
        grid-template-columns: 1fr;
        gap: var(--ts-space-1);
    }
    .ts-header-main__brand {
        justify-self: center;
    }
    .ts-header-main__search {
        justify-self: stretch;
        max-width: none;
    }
    .ts-header-main__user {
        justify-self: stretch;
    }
    .ts-header-user-row {
        justify-content: flex-end;
    }
    .ts-header-user-roles {
        max-width: 100%;
    }
}

/* Search box in header */
input.form-autocomplete {
    background: var(--ts-surface) url(cssimages/ico.search.gif) no-repeat calc(100% - 8px) center;
    border: 1px solid var(--ts-border-strong);
    border-radius: var(--ts-radius-sm);
    padding-right: 28px;
    height: var(--ts-input-height);
    font-size: var(--ts-font-base);
    font-weight: normal;
    transition: border-color var(--ts-transition), box-shadow var(--ts-transition);
}
input.form-autocomplete:focus {
    border-color: var(--ts-primary-light);
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--ts-primary) 15%, transparent);
    outline: none;
}

/* jQuery UI autocomplete dropdown */
#ui-id-1,
.ui-autocomplete {
    font-family: var(--ts-font-family);
    font-size: var(--ts-font-base);
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    box-shadow: var(--ts-shadow-lg);
}
.ts-header-search-menu {
    min-width: 560px;
    max-width: min(760px, calc(100vw - 24px));
    max-height: min(420px, calc(100vh - 120px));
    overflow-y: auto;
    overflow-x: hidden;
    padding: 0;
}
.ts-header-search-menu .ui-menu-item {
    margin: 0;
}
.ts-header-search-menu .ui-menu-item + .ui-menu-item {
    border-top: 1px solid var(--ts-border);
}
.ts-header-search-menu .ts-search-item {
    display: grid;
    grid-template-columns: 118px minmax(0, 1fr);
    align-items: stretch;
    gap: 0;
    padding: 0;
    text-decoration: none;
    color: var(--ts-text);
    min-height: 34px;
}
.ts-header-search-menu .ts-search-item--no-key {
    grid-template-columns: minmax(0, 1fr);
}
.ts-header-search-menu .ts-search-item__key {
    display: flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-family: var(--ts-font-mono);
    font-size: 12px;
    font-weight: 700;
    color: var(--ts-primary);
    background-color: var(--ts-surface-muted);
    border-right: 1px solid var(--ts-border);
    padding: 0 var(--ts-space-2);
    text-align: center;
    letter-spacing: 0.15px;
}
.ts-header-search-menu .ts-search-item__key--query {
    font-size: 11px;
    letter-spacing: 0.4px;
    color: var(--ts-primary-strong);
    text-transform: uppercase;
    background-color: var(--ts-primary-soft);
}
.ts-header-search-menu .ts-search-item__main {
    min-width: 0;
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px var(--ts-space-2);
    line-height: 1.2;
}
.ts-header-search-menu .ts-search-item__icons {
    width: 32px;
    min-width: 32px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 4px;
}
.ts-header-search-menu .ts-search-item__icons img {
    width: 16px;
    height: 16px;
    object-fit: contain;
    flex: 0 0 auto;
}
.ts-header-search-menu .ts-search-item__avatar {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex: 0 0 auto;
    font-size: 10px;
    font-weight: 700;
    line-height: 1;
    text-transform: uppercase;
    color: var(--ts-search-avatar-fg, #ffffff);
    background-color: var(--ts-search-avatar-bg, var(--ts-primary));
    box-shadow: inset 0 0 0 1px var(--ts-search-avatar-border, color-mix(in srgb, #000000 12%, transparent));
}
.ts-header-search-menu .ts-search-item__title {
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: var(--ts-font-sm);
    font-weight: 500;
}
.ts-header-search-menu .ts-search-item--query .ts-search-item__title {
    font-weight: 600;
}
.ts-header-search-menu .ui-state-hover,
.ts-header-search-menu .ui-state-focus,
.ts-header-search-menu .ui-state-active {
    border-color: transparent;
    background: transparent;
    margin: 0;
}
.ts-header-search-menu .ts-search-item:hover,
.ts-header-search-menu .ui-state-hover.ts-search-item,
.ts-header-search-menu .ui-state-focus.ts-search-item,
.ts-header-search-menu .ui-state-active.ts-search-item {
    background-color: var(--ts-primary-soft);
}
.ts-header-search-menu .ts-search-item:hover .ts-search-item__key,
.ts-header-search-menu .ui-state-hover.ts-search-item .ts-search-item__key,
.ts-header-search-menu .ui-state-focus.ts-search-item .ts-search-item__key,
.ts-header-search-menu .ui-state-active.ts-search-item .ts-search-item__key {
    background-color: rgba(52, 152, 219, 0.12);
    background-color: color-mix(in srgb, var(--ts-primary-soft) 55%, var(--ts-surface-muted));
}

@media (max-width: 900px) {
    .ts-header-search-menu {
        min-width: 0;
        width: calc(100vw - 24px);
        max-width: calc(100vw - 24px);
    }
    .ts-header-search-menu .ts-search-item {
        grid-template-columns: 90px minmax(0, 1fr);
    }
}


/* ── Control panel / toolbar ──────────────────────────────── */

div.controlPanel {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--ts-space-1);
    border-top: 1px solid var(--ts-border);
    border-bottom: 1px solid var(--ts-border);
    background-color: var(--ts-surface-muted);
    padding: var(--ts-space-1) var(--ts-space-3);
    line-height: normal;
}

/* controlPanel inside blueborder: lighter style, visible buttons */
div.blueborder > div.controlPanel {
    border-top: none;
    background-color: var(--ts-surface-muted);
    padding: var(--ts-space-1) var(--ts-space-3);
    gap: var(--ts-space-1);
}
div.blueborder > div.controlPanel A {
    color: var(--ts-text);
    border: 1px solid var(--ts-border);
    background-color: var(--ts-surface);
    font-weight: 500;
}
div.blueborder > div.controlPanel A:hover {
    color: var(--ts-primary);
    background-color: var(--ts-primary-soft);
    border-color: var(--ts-primary);
}

/* Hide controlPanel when it has no visible interactive content */
div.controlPanel:not(:has(a, input, select, button, .ts-menu-bar)) {
    display: none;
}

div.controlPanel A {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: var(--ts-font-sm);
    font-weight: 500;
    color: var(--ts-text-muted);
    text-decoration: none;
    padding: var(--ts-space-1) var(--ts-space-2);
    border: 1px solid transparent;
    border-radius: var(--ts-radius-sm);
    transition: all var(--ts-transition);
    white-space: nowrap;
    background-image: none;
    margin: 1px 2px;
}
div.controlPanel A:hover,
div.controlPanel A.selected,
div.controlPanel A#selected {
    color: var(--ts-text);
    background-color: var(--ts-surface-muted);
    border-color: var(--ts-border);
}

div.controlPanel label.expandable .closed A,
div.controlPanel label.expandable .opened A {
    background-image: none;
}

div.controlPanel select {
    font-size: var(--ts-font-sm);
}

div.controlPanel INPUT {
    border: 1px solid var(--ts-border-strong);
    background-color: var(--ts-surface);
    cursor: pointer;
}
div.controlPanel INPUT:hover {
    border-color: var(--ts-primary);
    background-color: var(--ts-surface);
}

div.controlPanel IMG {
    border: 0;
    padding-right: 2px;
    vertical-align: middle;
    background-color: transparent;
}

div.controlPanel span.separator {
    display: inline-block;
    width: 1px;
    height: 16px;
    background-color: var(--ts-border);
    margin: 0 var(--ts-space-2);
    vertical-align: middle;
    font-size: 0;
}

/* Tree toggle */
.tree-toggle-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    font-size: 14px;
    color: var(--ts-text-muted);
    cursor: pointer;
    border-radius: var(--ts-radius-sm);
    transition: background-color var(--ts-transition);
    user-select: none;
}
.tree-toggle-button:hover {
    background-color: var(--ts-surface-muted);
}


/* ── Breadcrumb path ──────────────────────────────────────── */

DIV.logopath {
    font-size: var(--ts-font-sm);
    color: var(--ts-text-muted);
    padding: var(--ts-space-2) 0;
    margin: 0;
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 2px;
}
DIV.logopath A {
    font-size: var(--ts-font-sm);
    font-weight: 500;
    color: var(--ts-text-muted);
    text-decoration: none;
    padding: 2px 4px;
    border-radius: 4px;
    transition: background-color var(--ts-transition-fast), color var(--ts-transition-fast);
}
DIV.logopath A:hover {
    color: var(--ts-primary);
    background-color: var(--ts-primary-soft);
}
DIV.logopath A.internal:after,
span.separated:after {
    color: var(--ts-border-strong);
    font-weight: normal;
    padding: 0 2px;
}
DIV.logopath IMG {
    vertical-align: middle;
}


/* ── Task title ───────────────────────────────────────────── */

DIV.taskTitle {
    margin: 0 0 var(--ts-space-3) 0;
    padding: var(--ts-space-2) 0;
    border-bottom: 1px solid var(--ts-border);
}
DIV.taskTitle A {
    font-size: var(--ts-font-xl);
    font-weight: 600;
    color: var(--ts-text);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 6px;
}
DIV.taskTitle A:hover {
    color: var(--ts-primary);
}
DIV.taskTitle A IMG,
DIV.taskTitle IMG {
    vertical-align: middle;
}
DIV.taskTitle SPAN {
    font-size: var(--ts-font-xl);
    font-weight: 600;
    color: var(--ts-text);
}
DIV.taskTitle em.number {
    font-style: normal;
    font-size: var(--ts-font-base);
    font-weight: 400;
    color: var(--ts-text-muted);
    margin-left: 4px;
}


/* ── TABLE.general — main data table ──────────────────────── */

TABLE.general {
    width: 100%;
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    background-color: var(--ts-surface);
    overflow: hidden;
    box-shadow: none;
    margin-bottom: var(--ts-space-4);
    border-collapse: separate;
    border-spacing: 0;
}

TABLE.general CAPTION {
    background-color: var(--ts-surface-muted);
    border: 1px solid var(--ts-border);
    border-bottom: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm) var(--ts-radius-sm) 0 0;
    color: var(--ts-text);
    font-size: var(--ts-font-base);
    font-weight: 600;
    padding: var(--ts-space-2) var(--ts-space-3);
    text-align: left;
    letter-spacing: 0;
}

TABLE.general TH {
    background-color: var(--ts-surface-muted);
    color: var(--ts-text-muted);
    font-weight: 700;
    font-size: 0.8rem;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    padding: var(--ts-space-2) var(--ts-space-3);
    border-bottom: 1px solid var(--ts-border);
    text-align: right;
}

TABLE.general TD {
    padding: var(--ts-space-2) var(--ts-space-3);
    color: var(--ts-text);
    font-size: var(--ts-font-base);
    border-bottom: 1px solid var(--ts-border);
}

TABLE.general TR:last-child TD,
TABLE.general TR:last-child TH {
    border-bottom: none;
}

TABLE.general TR.wide TH {
    background-color: rgba(0,214,143,0.06);
    color: var(--ts-text);
    font-weight: 600;
    font-size: var(--ts-font-base);
    text-align: left;
}

TABLE.general TR.wide TH.secondary {
    background-color: var(--ts-surface-muted);
}

/* Alternating rows */
TABLE.general TR.line0 TD,
TABLE.general TR.line0 TD div.line0,
TABLE.general TR.line0 TD div.line0 TABLE.general TD,
TABLE.general TR.line0 TD div.line0 TABLE.general TH,
TABLE.general TR.line0 TD div.line1,
TABLE.general TR.line0 TD div.line1 TABLE.general TD,
TABLE.general TR.line0 TD div.line1 TABLE.general TH {
    background-color: var(--ts-surface) !important;
}

TABLE.general TR.line1 TD,
TABLE.general TR.line1 TD div.line0,
TABLE.general TR.line1 TD div.line0 TABLE.general TD,
TABLE.general TR.line1 TD div.line0 TABLE.general TH,
TABLE.general TR.line1 TD div.line1,
TABLE.general TR.line1 TD div.line1 TABLE.general TD,
TABLE.general TR.line1 TD div.line1 TABLE.general TH {
    background-color: var(--ts-surface-muted) !important;
}

div.line0, div.line0 TABLE.general TD, div.line0 TABLE.general TH {
    background-color: var(--ts-surface);
}
div.line1, div.line1 TABLE.general TD, div.line1 TABLE.general TH {
    background-color: var(--ts-surface-muted);
}

/* Row hover */
TABLE.general TR.line0:hover TD,
TABLE.general TR.line1:hover TD,
TABLE.general TR.one:hover TD,
TABLE.general TR.two:hover TD {
    background-color: var(--ts-bg) !important;
}

TABLE.general TR.one TD {
    background-color: var(--ts-surface-muted);
}
TABLE.general TR.two TD {
    background-color: var(--ts-surface);
}

/* Overdue rows keep their red tint */
tr.overdue.line0 TD, tr.overdue.line0 TH {
    background-color: var(--ts-danger-soft) !important;
}
tr.overdue.line1 TD, tr.overdue.line1 TH {
    background-color: #f9d4d4 !important;
}

/* Strut separator between two-column sections */
TABLE.general TD.strut {
    width: 2px;
    padding: 0;
    background-color: transparent !important;
    border-left: 1px solid var(--ts-border);
    border-right: 1px solid var(--ts-border);
    border-bottom-color: transparent;
}

TABLE.general TD.selected,
TABLE.general TR.selected TD {
    background-color: var(--ts-primary-soft);
    font-weight: 600;
}

TABLE.general TD.message {
    background-color: var(--ts-surface);
    padding: var(--ts-space-2) var(--ts-space-3);
}

TABLE.general IMG {
    vertical-align: middle;
}


/* ── DIV.caption / DIV.ncaption ───────────────────────────── */

DIV.caption {
    font-size: var(--ts-font-md);
    font-weight: 600;
    color: var(--ts-text);
    background-color: var(--ts-surface-muted);
    border-bottom: 1px solid var(--ts-border);
    border-top: none;
    padding: var(--ts-space-2) var(--ts-space-3);
    letter-spacing: 0;
}

/* Caption inside blueborder: clean header */
div.blueborder > DIV.caption {
    background: transparent;
    border-bottom: 1px solid var(--ts-border);
    padding: var(--ts-space-2) var(--ts-space-3);
    overflow: hidden; /* contain floats */
    line-height: 28px;
}

DIV.caption A {
    font-size: var(--ts-font-base);
    font-weight: 600;
    color: var(--ts-primary-light);
    letter-spacing: 0;
}

/* Action links in blueborder caption: chip-buttons
   Uses !important to override inline style="float:right; font-weight:normal; padding-right:20px" */
div.blueborder > DIV.caption A.link {
    font-size: var(--ts-font-sm) !important;
    font-weight: 500 !important;
    color: var(--ts-text-muted) !important;
    text-decoration: none !important;
    padding: 3px var(--ts-space-2) !important;
    border: 1px solid var(--ts-border) !important;
    border-radius: var(--ts-radius-sm) !important;
    background-color: var(--ts-surface) !important;
    margin-left: var(--ts-space-1) !important;
    transition: all var(--ts-transition);
    white-space: nowrap;
    line-height: normal;
}
div.blueborder > DIV.caption A.link:hover {
    color: var(--ts-primary) !important;
    background-color: var(--ts-primary-soft) !important;
    border-color: var(--ts-primary) !important;
}
div.blueborder > DIV.caption A.link IMG,
div.blueborder > DIV.caption IMG {
    vertical-align: middle;
    border: 0 !important;
    margin-right: 2px;
}

/* Title link in caption */
div.blueborder > DIV.caption A.internal_properties {
    font-size: var(--ts-font-md) !important;
    font-weight: 600 !important;
    color: var(--ts-text) !important;
    text-decoration: none;
}

/* Navigation block in caption */
div.blueborder > DIV.caption DIV.navigation {
    display: inline;
    font-size: var(--ts-font-sm);
    color: var(--ts-text-muted);
    margin-left: var(--ts-space-2);
}
div.blueborder > DIV.caption DIV.navigation A {
    font-size: var(--ts-font-sm);
    font-weight: 500;
    color: var(--ts-text-muted);
}

DIV.ncaption {
    font-size: var(--ts-font-base);
    font-weight: 600;
    color: var(--ts-text);
    background-color: var(--ts-surface-muted);
    border-bottom: 1px solid var(--ts-border);
    padding: var(--ts-space-2) var(--ts-space-3);
}


/* ── Tabs (TABLE.tabbedpane) — CSS-only, no images ────────── */

TABLE.tabbedpane {
    margin-top: var(--ts-space-4);
    margin-bottom: 0;
}

TABLE.tabbedpane TD LI A {
    float: left;
    background: none !important;
    border: none;
    border-bottom: 2px solid transparent;
    border-radius: 0;
    padding: var(--ts-space-2) var(--ts-space-3);
    margin-right: var(--ts-space-1);
    color: var(--ts-text-muted);
    font-weight: 500;
    font-size: var(--ts-font-base);
    transition: all var(--ts-transition);
    text-decoration: none;
}

TABLE.tabbedpane TD LI A SPAN {
    float: none;
    display: inline;
    background: none !important;
    padding: 0;
}

TABLE.tabbedpane TD A:link,
TABLE.tabbedpane TD A:visited,
TABLE.tabbedpane TD A:active {
    color: var(--ts-text-muted);
    font-size: var(--ts-font-base);
    font-weight: 500;
}

TABLE.tabbedpane TD LI A:hover {
    color: var(--ts-primary);
    border-bottom-color: var(--ts-primary-soft);
    background: none !important;
}
TABLE.tabbedpane TD LI A:hover SPAN {
    background: none !important;
}

TABLE.tabbedpane TD LI#selectedtab A,
TABLE.tabbedpane TD LI#selectedtab A:hover {
    color: var(--ts-primary);
    border-bottom-color: var(--ts-primary-light);
    font-weight: 600;
    background: none !important;
}
TABLE.tabbedpane TD LI#selectedtab A SPAN {
    background: none !important;
    padding: 0;
}

DIV.tabcontent {
    border: 1px solid var(--ts-border);
    border-radius: 0 0 var(--ts-radius-sm) var(--ts-radius-sm);
    background-color: var(--ts-surface);
    padding: var(--ts-space-3);
    box-shadow: none;
}


/* ── Pagination ───────────────────────────────────────────── */

.ts-pagination {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--ts-space-2);
    padding: var(--ts-space-2) 0 var(--ts-space-4);
}
.ts-pagination__info {
    font-size: var(--ts-font-sm);
    color: var(--ts-text-muted);
}
.ts-pagination .slider {
    padding: var(--ts-space-2) 0;
}
.ts-pagination--top {
    padding: 0 0 var(--ts-space-2);
}


/* ── Pagination (DIV.slider) ──────────────────────────────── */

DIV.slider {
    font-size: var(--ts-font-base);
    font-weight: 500;
    padding: var(--ts-space-3) 0;
    background-color: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--ts-space-1);
}
DIV.slider A {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    height: 32px;
    font-size: var(--ts-font-base);
    font-weight: 500;
    color: var(--ts-text);
    text-decoration: none;
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    padding: 0 var(--ts-space-2);
    transition: all var(--ts-transition);
}
DIV.slider A:hover {
    background-color: var(--ts-primary-soft);
    border-color: var(--ts-primary);
    color: var(--ts-primary);
}
DIV.slider SPAN {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    height: 32px;
    font-size: var(--ts-font-base);
    font-weight: 600;
    color: #0A1628;
    background-color: var(--ts-accent);
    border: 1px solid var(--ts-accent);
    border-radius: var(--ts-radius-sm);
    padding: 0 var(--ts-space-2);
}


/* ── Labels / expandable sections ─────────────────────────── */

LABEL.expandable,
LABEL.loadable {
    font-weight: 600;
    font-size: var(--ts-font-base);
    color: var(--ts-text);
}
LABEL.expandable A {
    font-weight: 600;
    font-size: var(--ts-font-base);
}

A.history-closed,
A.history-opened {
    font-size: var(--ts-font-base);
    font-weight: 600;
    color: var(--ts-text);
}

.fx LABEL.opened {
    background-color: var(--ts-primary-soft);
    border-top: 3px solid var(--ts-primary-light);
    border-left: 1px solid var(--ts-border);
    border-right: 1px solid var(--ts-border);
    border-bottom: 1px solid var(--ts-border);
}
.fx LABEL.closed {
    border: 1px solid var(--ts-border);
}


/* ── Message boxes ────────────────────────────────────────── */

div.msgbox-closed,
div.msgbox-opened {
    font-size: var(--ts-font-base);
    color: var(--ts-text);
}

div.msgbox-opened div.description {
    padding-left: 58px;
}

.msgbox-opened TABLE.general {
    border: 0;
    box-shadow: none;
    margin-bottom: 0;
}


/* ── Yellowbox / Bluebox / Dropdown ───────────────────────── */

DIV#yellowbox, DIV.yellowbox {
    border: 1px solid var(--ts-warning);
    border-radius: var(--ts-radius-sm);
    padding: var(--ts-space-2);
}
DIV#bluebox, DIV.bluebox {
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    padding: var(--ts-space-2);
    background-color: var(--ts-surface-muted);
}
DIV.dropdown {
    border: 1px solid var(--ts-warning);
    border-radius: var(--ts-radius-sm);
    padding: var(--ts-space-2);
}


/* ── Error / Notice tables ────────────────────────────────── */

TABLE.error,
TABLE.error.ts-message-error {
    border: 1px solid var(--ts-danger);
    border-radius: var(--ts-radius-md);
    background-color: var(--ts-danger-soft);
    overflow: hidden;
}
TABLE.error CAPTION {
    background-color: #e8b4b4;
    border-color: var(--ts-danger);
    color: var(--ts-text);
    font-weight: 600;
}
TABLE.error TD {
    font-size: var(--ts-font-base);
}

TABLE.notice {
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-md);
    background-color: var(--ts-surface-muted);
    overflow: hidden;
}
TABLE.notice CAPTION {
    background-color: var(--ts-surface-muted);
    border-color: var(--ts-border);
    font-weight: 600;
}
TABLE.notice TD {
    font-size: var(--ts-font-base);
}


/* ── TSMenu dropdown ──────────────────────────────────────── */

.ts-menu {
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    background: var(--ts-surface);
    box-shadow: var(--ts-shadow-lg);
    padding: var(--ts-space-1);
}
.ts-menu a {
    font-size: var(--ts-font-sm);
    color: var(--ts-text);
    padding: var(--ts-space-1) var(--ts-space-2);
    border-radius: 4px;
    white-space: normal;
    line-height: var(--ts-line-height);
    transition: background-color var(--ts-transition-fast);
}
.ts-menu a:hover {
    color: var(--ts-text);
    background-color: var(--ts-primary-soft);
}
.ts-menu a.sep {
    background-color: var(--ts-border);
    margin: var(--ts-space-1) 0;
    height: 1px;
    padding: 0;
}
.ts-menu-empty {
    font-size: var(--ts-font-sm);
    color: var(--ts-text-muted);
    border-color: transparent;
}
.ts-menu-item-first-td,
.ts-menu-item-second-td {
    font-size: var(--ts-font-sm);
}


/* ── TSMenu bar ───────────────────────────────────────────── */

.ts-menu-bar {
    background-color: var(--ts-surface);
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    font-size: var(--ts-font-sm);
    padding: var(--ts-space-1) var(--ts-space-2);
}
.ts-menu-bar a,
.ts-menu-bar a:visited {
    font-size: var(--ts-font-sm);
    color: var(--ts-text-muted);
    border: 1px solid transparent;
    border-radius: 4px;
    padding: var(--ts-space-1) var(--ts-space-2);
    margin-left: 2px;
    background-image: none;
    text-decoration: none;
    font-weight: 500;
}
.ts-menu-bar a:hover {
    color: var(--ts-text);
    background: var(--ts-primary-soft);
    background-image: none;
    border-color: var(--ts-border);
}
.ts-menu-bar a:active,
.ts-menu-bar a:focus {
    border-color: var(--ts-primary);
    outline: none;
}
.ts-menu-bar a .arrow {
    border: 0;
    float: none;
}


/* ── Icons ────────────────────────────────────────────────── */

img.icon,
html\:img.icon {
    height: 16px;
    width: 16px;
    object-fit: contain;
    vertical-align: middle;
    image-rendering: auto;
}

img[src*="/cssimages/ico."] {
    border-radius: 0;
    background-color: transparent;
    border: 0;
    padding: 0;
    box-sizing: content-box;
}

img.state {
    height: 10px;
    width: 10px;
    border-radius: 50%;
    vertical-align: middle;
    margin-right: 5px;
    display: inline-block;
    flex-shrink: 0;
    background-color: var(--sc, var(--ts-text-muted-2));
    box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.28);
    background-color: color-mix(in srgb, var(--sc, var(--ts-text-muted-2)) 92%, #000);
    box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--sc, var(--ts-border-strong)) 45%, #000);
}


/* ── Status badge ─────────────────────────────────────────── */

.ts-status-badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: var(--ts-font-xs);
    font-weight: 600;
    white-space: nowrap;
    line-height: 1.5;
    background-color: var(--sc, var(--ts-primary-soft));
    background-color: color-mix(in srgb, var(--sc, var(--ts-primary)) 12%, white);
    color: var(--ts-text);
    border: 1px solid var(--sc, var(--ts-primary));
    border: 1px solid color-mix(in srgb, var(--sc, var(--ts-primary)) 28%, var(--ts-border));
    vertical-align: middle;
}


/* ── Quick filter ─────────────────────────────────────────── */

.ts-quick-filter {
    display: flex;
    align-items: center;
    gap: var(--ts-space-2);
    margin: 0 0 var(--ts-space-3);
}
.ts-quick-filter__input {
    width: min(480px, 100%);
    padding: var(--ts-space-2) var(--ts-space-3);
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    background-color: var(--ts-surface);
    color: var(--ts-text);
    font-size: var(--ts-font-base);
    transition: border-color var(--ts-transition), box-shadow var(--ts-transition);
}
.ts-quick-filter__input:focus {
    border-color: var(--ts-primary);
    box-shadow: 0 0 0 2px var(--ts-primary-soft);
    outline: none;
}


/* ── Task list tweaks ─────────────────────────────────────── */

TABLE.general.ts-task-list TH,
TABLE.general.ts-task-list TD {
    padding: var(--ts-space-3) var(--ts-space-3);
    vertical-align: middle;
}


/* ── Task number in list ──────────────────────────────────── */

TABLE.general span.internal {
    font-family: var(--ts-font-mono);
    font-size: var(--ts-font-xs);
    color: var(--ts-text-muted);
    font-weight: 500;
    letter-spacing: 0.2px;
}


/* ── Priority cell metadata ───────────────────────────────── */

.ts-priority-cell {
    --ts-priority-color: var(--ts-warning);
}


/* ── User avatar ──────────────────────────────────────────── */

.ts-user {
    display: inline-flex;
    align-items: center;
    gap: var(--ts-space-1);
    font-weight: 600;
    color: var(--ts-text);
}
.ts-user__name {
    color: var(--ts-primary);
}
.ts-avatar {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background-color: var(--ts-user-avatar-bg, var(--ts-primary));
    color: var(--ts-user-avatar-fg, #ffffff);
    border: none;
    box-shadow: inset 0 0 0 1px color-mix(in srgb, #000000 12%, transparent);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: 700;
    line-height: 1;
    text-transform: uppercase;
    flex-shrink: 0;
}
.ts-avatar--group {
    background-color: var(--ts-primary-soft);
    color: var(--ts-primary);
    border-color: var(--ts-primary);
    border-color: color-mix(in srgb, var(--ts-primary) 50%, var(--ts-border));
}
#loggedUser.ts-user .ts-user__name {
    color: var(--ts-success);
}


/* ── Relative time ────────────────────────────────────────── */

.ts-relative-time {
    white-space: nowrap;
    font-variant-numeric: tabular-nums;
    color: var(--ts-text-muted);
}
.ts-relative-time__sortkey {
    font-size: 0;
    line-height: 0;
    color: transparent;
    user-select: none;
}
.ts-relative-time__label {
    font-variant-numeric: tabular-nums;
}


/* ── Sort/filter header ───────────────────────────────────── */

TABLE.sortfilter {
    font-size: var(--ts-font-sm);
}
TABLE.sortfilter TD {
    padding: var(--ts-space-1) var(--ts-space-2);
}
TABLE.sortfilter A {
    color: var(--ts-text-muted);
    text-decoration: none;
    font-weight: 600;
}
TABLE.sortfilter A:hover {
    color: var(--ts-primary);
}


/* ── Post-filtering area ──────────────────────────────────── */

#postFiltering {
    margin-top: var(--ts-space-2);
}
#postFiltering table.general {
    width: 100%;
    border-collapse: collapse;
}
#postFiltering table.general CAPTION {
    text-align: left;
}
#postFiltering table.general TH {
    font-size: var(--ts-font-sm);
    font-weight: 600;
    color: var(--ts-text-muted);
    white-space: nowrap;
    padding: var(--ts-space-2) var(--ts-space-3);
}
#postFiltering table.general TD {
    font-size: var(--ts-font-sm);
    padding: var(--ts-space-2) var(--ts-space-3);
}
#postFiltering table.general TR + TR {
    border-top: 1px solid var(--ts-border);
}
#postFiltering SELECT {
    min-width: 180px;
}
#postFiltering .controls {
    text-align: right;
    padding: var(--ts-space-3) 0;
    display: flex;
    justify-content: flex-end;
    gap: var(--ts-space-2);
}


/* ── Footer ───────────────────────────────────────────────── */

TABLE.allrights,
TABLE.allrights TD,
.ts-footer {
    font-size: var(--ts-font-xs);
    color: var(--ts-text-muted);
}
TABLE.allrights A {
    color: var(--ts-text-muted);
    font-size: var(--ts-font-xs);
}
TABLE.allrights {
    margin-top: var(--ts-space-6);
    background: transparent;
}

span.expired {
    background-color: var(--ts-danger);
    border-radius: var(--ts-radius-sm);
    font-size: var(--ts-font-sm);
}


/* ── Task info helpers ────────────────────────────────────── */

.ts-task-layout {
    display: grid;
    grid-template-columns: minmax(0, 1fr) minmax(280px, 360px);
    gap: var(--ts-space-4);
    align-items: start;
}

.ts-task-layout.ts-task-layout--single {
    grid-template-columns: minmax(0, 1fr);
}

.ts-task-layout__full {
    grid-column: 1 / -1;
}

.ts-task-layout > .strut {
    display: none;
}

.ts-task-main {
    grid-column: 1;
    min-width: 0;
}

.ts-task-sidebar {
    grid-column: 2;
    min-width: 0;
}

.ts-task-layout.ts-task-layout--single .ts-task-main,
.ts-task-layout.ts-task-layout--single .ts-task-sidebar,
.ts-task-layout.ts-task-layout--single .ts-task-layout__full {
    grid-column: 1;
}

.ts-task-main .taskDescription {
    margin-left: 0;
    max-width: none;
}

.ts-task-main--activity > .strut {
    display: none;
}

.ts-task-main-actions {
    grid-column: 1 / -1;
    margin-bottom: var(--ts-space-1);
}

.ts-task-workflow-toolbar {
    grid-column: 1 / -1;
    margin-top: var(--ts-space-1);
    margin-bottom: var(--ts-space-2);
}

div.controlPanel.ts-task-main-actions {
    display: flex;
    flex-wrap: nowrap;
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    background-color: var(--ts-surface);
    gap: var(--ts-space-2);
    padding: var(--ts-space-2) var(--ts-space-3);
    overflow-x: auto;
    overflow-y: hidden;
    align-items: center;
}

div.controlPanel.ts-task-main-actions A {
    color: var(--ts-text);
    border: 1px solid var(--ts-border);
    background-color: var(--ts-surface-muted);
    font-weight: 600;
}

div.controlPanel.ts-task-main-actions A:hover,
div.controlPanel.ts-task-main-actions A.selected,
div.controlPanel.ts-task-main-actions A#selected {
    color: var(--ts-primary);
    background-color: var(--ts-primary-soft);
    border-color: var(--ts-primary);
}

.ts-task-toolbar-main {
    display: inline-flex;
    align-items: center;
    flex-wrap: nowrap;
    gap: var(--ts-space-2);
    min-width: fit-content;
    white-space: nowrap;
    flex: 0 0 auto;
}

.ts-task-toolbar-main > span.additional {
    margin-left: 0;
}

div.controlPanel.ts-task-main-actions .ts-task-toolbar-divider {
    width: 1px;
    height: 24px;
    min-height: 24px;
    margin: 0 var(--ts-space-1);
    background-color: var(--ts-border-strong);
    align-self: center;
    flex: 0 0 auto;
}

.ts-task-toolbar-secondary {
    display: inline-flex;
    align-items: center;
    justify-content: flex-start;
    flex-wrap: nowrap;
    gap: var(--ts-space-2);
    min-width: fit-content;
    margin-left: 0;
    padding-left: 0;
    white-space: nowrap;
    flex: 0 0 auto;
}

div.controlPanel.ts-task-main-actions .ts-task-toolbar-secondary A {
    background-color: var(--ts-surface-muted);
    border-color: var(--ts-border);
}

div.controlPanel.ts-task-main-actions .ts-menu-bar {
    /* L6: Inherits from base .ts-menu-bar styles */
    background: transparent;
    border: none;
    padding: 0;
}

div.controlPanel.ts-task-main-actions .ts-menu-bar a,
div.controlPanel.ts-task-main-actions .ts-menu-bar a:visited {
    /* L6: Inherits from base .ts-menu-bar, overrides only specific properties */
    color: var(--ts-text);
    background-color: var(--ts-surface-muted);
    font-weight: 600;
}

div.controlPanel.ts-task-main-actions .ts-menu-bar a:hover,
div.controlPanel.ts-task-main-actions .ts-menu-bar a:focus,
div.controlPanel.ts-task-main-actions .ts-menu-bar a:active {
    /* L6: Inherits from base .ts-menu-bar hover/focus/active */
    color: var(--ts-primary);
    background-color: var(--ts-primary-soft);
    border-color: var(--ts-primary);
}

@media (max-width: 1180px) {
    div.controlPanel.ts-task-main-actions {
        grid-template-columns: minmax(0, 1fr);
        row-gap: var(--ts-space-2);
    }

    div.controlPanel.ts-task-main-actions .ts-task-toolbar-divider {
        display: none;
    }

    .ts-task-toolbar-secondary {
        justify-content: flex-start;
    }
}

.ts-task-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--ts-space-2);
    padding: var(--ts-space-2) var(--ts-space-3);
    border-bottom: 1px solid var(--ts-border);
    background-color: var(--ts-surface-muted);
}

.ts-task-actions + .controlPanel {
    border-top: none;
}

.ts-task-properties-wrap {
    padding-left: 0;
    padding-right: 0;
}

TABLE.general.ts-task-properties {
    margin-bottom: 0;
    table-layout: fixed;
}

TABLE.general.ts-task-properties TH,
TABLE.general.ts-task-properties TD {
    width: auto;
    text-align: left;
    vertical-align: top;
}

TABLE.general.ts-task-properties .taskinfo-right.ts-task-property-group {
    letter-spacing: 0.06em;
}

.ts-task-property-group-title {
    color: var(--ts-text);
}

TABLE.general.ts-task-properties tr.ts-task-property-label-row TH {
    border-bottom: none;
    padding-bottom: 2px;
    font-size: var(--ts-font-xs);
    font-weight: 700;
    text-transform: uppercase;
    color: var(--ts-text-muted);
}

TABLE.general.ts-task-properties tr.ts-task-property-value-row TD {
    padding-top: 0;
    padding-left: var(--ts-space-4);
    border-bottom: 1px solid var(--ts-border);
    word-break: break-word;
}

TABLE.general.ts-task-properties tr.ts-task-property-value-row:last-child TD {
    border-bottom: none;
}

TABLE.general.ts-task-customfields {
    margin-top: var(--ts-space-2);
    margin-bottom: 0;
}

TABLE.general.ts-task-customfields colgroup {
    display: none;
}

/* Keep !important to override legacy TABLE.general.customfields display rules. */
TABLE.general.ts-task-customfields tr {
    display: block !important;
    border-bottom: 1px solid var(--ts-border);
    padding: var(--ts-space-1) 0 var(--ts-space-2);
}

TABLE.general.ts-task-customfields tr:last-child {
    border-bottom: none;
}

TABLE.general.ts-task-customfields tr TH,
TABLE.general.ts-task-customfields tr TD {
    display: block !important;
    width: auto;
    border: none;
    text-align: left;
}

TABLE.general.ts-task-customfields tr TH {
    padding: 0 !important;
    font-size: var(--ts-font-xs);
    font-weight: 700;
    text-transform: uppercase;
    color: var(--ts-text-muted);
    line-height: 1.3;
}

TABLE.general.ts-task-customfields tr TD {
    padding: var(--ts-space-1) 0 0 var(--ts-space-4) !important;
    word-break: break-word;
}

.ts-task-messages {
    margin-bottom: 0;
    border-radius: var(--ts-radius-md);
    overflow: hidden;
    border: 1px solid var(--ts-border);
    box-shadow: var(--ts-shadow-sm);
    background-color: var(--ts-surface);
}

.ts-task-messages > .caption {
    background: linear-gradient(180deg, color-mix(in srgb, var(--ts-primary-soft) 44%, #ffffff), var(--ts-surface));
    border-bottom: 1px solid var(--ts-border);
    padding: var(--ts-space-3) var(--ts-space-4);
}

.ts-task-messages #messageHistoryHeader {
    color: var(--ts-primary);
    font-weight: 700;
    letter-spacing: 0.01em;
}

.ts-message-history-caption {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--ts-space-2);
    flex-wrap: wrap;
}

.ts-message-history-caption__controls {
    display: inline-flex;
    align-items: center;
    gap: var(--ts-space-2);
    min-width: 0;
}

.ts-message-history-caption .ts-message-history-caption__search {
    height: 34px;
    min-width: 220px;
    width: clamp(220px, 28vw, 360px);
    border: 1px solid color-mix(in srgb, var(--ts-primary) 18%, var(--ts-border));
    border-radius: 999px;
    background: linear-gradient(180deg, #ffffff, color-mix(in srgb, var(--ts-surface) 88%, #ffffff));
    padding: 0 var(--ts-space-3);
    color: var(--ts-text);
    font-size: var(--ts-font-sm);
    box-shadow: inset 0 1px 0 color-mix(in srgb, #ffffff 88%, transparent);
}

.ts-message-history-caption .ts-message-history-caption__search:focus {
    outline: none;
    border-color: var(--ts-primary);
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--ts-primary) 16%, transparent);
}

.ts-message-history-caption .ts-message-sort-toggle,
.ts-message-history-caption .ts-message-sort-toggle:visited {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    color: var(--ts-text);
    text-decoration: none;
    font-size: var(--ts-font-sm);
    font-weight: 600;
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    background-color: var(--ts-surface);
    padding: var(--ts-space-1) var(--ts-space-2);
}

.ts-message-history-caption .ts-message-sort-toggle:hover {
    color: var(--ts-primary);
    border-color: var(--ts-primary);
    background-color: var(--ts-primary-soft);
}

.ts-workflow-toolbar {
    background:
        linear-gradient(180deg,
            color-mix(in srgb, var(--ts-primary-soft) 56%, #ffffff),
            color-mix(in srgb, var(--ts-surface-muted) 86%, #ffffff));
    border: 1px solid color-mix(in srgb, var(--ts-primary) 22%, var(--ts-border));
    border-left: 3px solid color-mix(in srgb, var(--ts-primary) 55%, var(--ts-border));
    border-radius: var(--ts-radius-sm);
    box-shadow: inset 0 1px 0 color-mix(in srgb, #ffffff 85%, transparent);
    padding: var(--ts-space-2) var(--ts-space-3);
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--ts-space-2);
}

.ts-workflow-toolbar.ts-message-history-toolbar--bottom {
    border-top: 1px solid color-mix(in srgb, var(--ts-primary) 22%, var(--ts-border));
    border-bottom: none;
    margin-top: var(--ts-space-1);
    border-radius: 0 0 var(--ts-radius-sm) var(--ts-radius-sm);
}

.ts-workflow-toolbar__group {
    display: inline-flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--ts-space-2);
}

.ts-workflow-toolbar__separator {
    width: 1px;
    height: 22px;
    background-color: var(--ts-border-strong);
    flex: 0 0 auto;
}

div.controlPanel.ts-workflow-toolbar A {
    background-color: var(--ts-surface-muted);
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    font-weight: 600;
}

div.controlPanel.ts-workflow-toolbar .ts-menu-bar {
    /* L6: Inherits from base .ts-menu-bar styles */
    background: transparent;
    border: none;
    padding: 0;
}

div.controlPanel.ts-workflow-toolbar .ts-menu-bar a,
div.controlPanel.ts-workflow-toolbar .ts-menu-bar a:visited {
    /* L6: Inherits from base .ts-menu-bar, overrides only specific properties */
    color: var(--ts-text);
    background-color: var(--ts-surface-muted);
    font-weight: 600;
}

/* R3: Removed duplicate A:hover rule - covered by .ts-menu-bar a:hover below */

div.controlPanel.ts-workflow-toolbar .ts-menu-bar a:hover,
div.controlPanel.ts-workflow-toolbar .ts-menu-bar a:focus,
div.controlPanel.ts-workflow-toolbar .ts-menu-bar a:active {
    /* L6: Inherits from base .ts-menu-bar hover/focus/active */
    color: var(--ts-primary);
    background-color: var(--ts-primary-soft);
    border-color: var(--ts-primary);
}

.ts-message-history-toolbar {
    flex-wrap: nowrap;
    overflow-x: auto;
    overflow-y: hidden;
}

.ts-message-history-toolbar .ts-workflow-toolbar__group,
.ts-message-history-toolbar .ts-menu-bar {
    flex-wrap: nowrap;
    white-space: nowrap;
}

.ts-activity-feed {
    padding: var(--ts-space-2);
    background:
        radial-gradient(circle at 8% 0%, color-mix(in srgb, var(--ts-primary) 12%, transparent), transparent 32%),
        var(--ts-surface);
}

/* Keep !important to neutralize legacy row striping (.line0/.line1) from old tables. */
.ts-activity-feed .ts-activity-item {
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    margin-bottom: var(--ts-space-2);
    overflow: hidden;
    background-color: var(--ts-surface) !important;
    box-shadow: var(--ts-shadow-xs);
    border-left: 3px solid color-mix(in srgb, var(--ts-border) 75%, #ffffff);
}

.ts-activity-feed .ts-activity-item.line0,
.ts-activity-feed .ts-activity-item.line1 {
    background-color: var(--ts-surface) !important;
}

.ts-activity-feed .ts-activity-item:last-child {
    margin-bottom: 0;
}

/* !important keeps semantic highlighting above legacy row backgrounds. */
.ts-activity-feed .ts-activity-item.hotmessage {
    background-color: color-mix(in srgb, var(--ts-warning-soft) 32%, var(--ts-surface)) !important;
    border-left-color: var(--ts-warning);
}

.ts-activity-feed .ts-activity-item.newmessage {
    background-color: color-mix(in srgb, var(--ts-primary-soft) 28%, var(--ts-surface)) !important;
    border-left-color: var(--ts-primary);
}

.ts-activity-feed .ts-activity-item__content.indent {
    padding: var(--ts-space-2) var(--ts-space-2) var(--ts-space-1);
}

.ts-activity-feed .msgbox-closed,
.ts-activity-feed .msgbox-opened {
    display: grid;
    grid-template-columns: 18px minmax(0, 1fr);
    column-gap: var(--ts-space-2);
    row-gap: var(--ts-space-1);
    position: relative;
    height: auto !important;
    overflow: visible;
    min-height: 24px;
    padding: 0;
}

.ts-activity-feed .ts-activity-item__header {
    grid-column: 2;
    display: grid;
    grid-template-columns: minmax(0, 1fr) auto;
    align-items: start;
    column-gap: var(--ts-space-1);
    row-gap: var(--ts-space-1);
    min-width: 0;
}

.ts-activity-feed .ts-activity-item__header.ts-activity-item__header--with-checkbox {
    grid-template-columns: auto minmax(0, 1fr) auto;
}

.ts-activity-feed .ts-activity-item__checkbox {
    position: static;
    margin: 3px 0 0;
}

.ts-activity-feed .msgbox-closed .description,
.ts-activity-feed .msgbox-closed .description PRE {
    display: none;
}

.ts-activity-feed .msgbox-opened .description {
    display: block;
    padding-left: 0;
    margin-top: var(--ts-space-1);
}

.ts-activity-feed .ts-activity-item__avatar {
    position: static;
    grid-column: 1;
    grid-row: 1;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    border: none;
    background-color: var(--ts-user-avatar-bg, var(--ts-primary));
    color: var(--ts-user-avatar-fg, #ffffff);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: 700;
    line-height: 1;
    text-transform: uppercase;
    margin-top: 0;
    box-shadow: inset 0 0 0 1px color-mix(in srgb, #000000 12%, transparent);
}

.ts-activity-feed .msgtime.ts-activity-item__time {
    grid-column: 2;
    justify-self: end;
    align-self: start;
    margin: 0;
    white-space: normal;
    min-width: 0;
}

.ts-activity-feed .ts-activity-item__header.ts-activity-item__header--with-checkbox .msgtime.ts-activity-item__time {
    grid-column: 3;
}

.ts-activity-feed .msgtime.ts-activity-item__time a {
    display: inline-flex;
    justify-content: flex-end;
    text-decoration: none;
    color: var(--ts-text-muted);
    max-width: 100%;
}

.ts-activity-feed .msgtime.ts-activity-item__time .ts-activity-item__time-text {
    display: inline-block;
    font-size: var(--ts-font-xs);
    color: var(--ts-text-muted) !important;
    background-color: color-mix(in srgb, var(--ts-surface-muted) 76%, #ffffff);
    border: 1px solid var(--ts-border);
    border-radius: 999px;
    padding: 1px 7px;
    line-height: 1.2;
    white-space: nowrap;
}

.ts-activity-feed .messagelabel.ts-activity-item__meta {
    grid-column: 1;
    display: block;
    line-height: 1.45;
    padding-right: 0;
    padding-left: 0;
    min-height: 18px;
    min-width: 0;
    overflow: hidden;
    color: var(--ts-text-muted);
}

.ts-activity-feed .ts-activity-item__header.ts-activity-item__header--with-checkbox .messagelabel.ts-activity-item__meta {
    grid-column: 2;
}

.ts-activity-feed .messagelabel.ts-activity-item__meta .user {
    white-space: normal;
}

.ts-activity-feed .ts-activity-item__user {
    vertical-align: top;
}

.ts-activity-feed .msgbox-opened TABLE.general {
    grid-column: 2;
    margin-top: var(--ts-space-1);
    border-radius: var(--ts-radius-sm);
    overflow: hidden;
}

.ts-activity-feed .msgbox-opened .description {
    grid-column: 2;
}

.ts-activity-feed .ts-activity-item__body {
    margin-top: 0;
}

.ts-activity-feed .ts-activity-item__body > :first-child {
    margin-top: 0;
}

.ts-message-history-controls {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: var(--ts-space-2);
    padding: var(--ts-space-3);
    border-top: 1px solid var(--ts-border);
    background-color: var(--ts-surface);
}

.ts-message-history-controls input.iconized {
    border-radius: var(--ts-radius-sm);
    font-weight: 600;
    min-height: 34px;
}

.ts-task-attachments > .caption {
    padding: var(--ts-space-3);
}

.ts-attachment-toolbar {
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    background-color: var(--ts-surface);
    padding: var(--ts-space-2) var(--ts-space-3);
    margin: var(--ts-space-2) var(--ts-space-2) 0;
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--ts-space-2);
}

div.blueborder > div.controlPanel.ts-attachment-toolbar {
    background-color: var(--ts-surface);
}

div.blueborder > div.controlPanel.ts-attachment-toolbar A,
div.blueborder > div.controlPanel.ts-attachment-toolbar A:visited {
    color: var(--ts-text);
    border: 1px solid var(--ts-border);
    background-color: var(--ts-surface-muted);
    border-radius: var(--ts-radius-sm);
    font-weight: 600;
    text-decoration: none;
    padding: var(--ts-space-1) var(--ts-space-2);
    margin: 1px 2px;
    display: inline-flex;
    align-items: center;
    gap: 4px;
}

div.blueborder > div.controlPanel.ts-attachment-toolbar A:hover,
div.blueborder > div.controlPanel.ts-attachment-toolbar A.selected,
div.blueborder > div.controlPanel.ts-attachment-toolbar A#selected {
    color: var(--ts-primary);
    background-color: var(--ts-primary-soft);
    border-color: var(--ts-primary);
}

.ts-attachment-toolbar__separator {
    width: 1px;
    height: 24px;
    background-color: var(--ts-border-strong);
    margin-left: var(--ts-space-1);
    margin-right: var(--ts-space-1);
    flex: 0 0 auto;
}

.ts-attachment-toolbar__search {
    margin-left: auto;
    flex: 1 1 320px;
    min-width: 220px;
    max-width: 420px;
}

.ts-attachment-toolbar .ts-attachment-filter.form-autocomplete {
    width: 100%;
    min-width: 0;
    height: 34px;
    border: 1px solid color-mix(in srgb, var(--ts-primary) 18%, var(--ts-border));
    border-radius: 999px;
    background: linear-gradient(180deg, #ffffff, color-mix(in srgb, var(--ts-surface) 88%, #ffffff));
    padding: 0 var(--ts-space-3);
    box-sizing: border-box;
    box-shadow: inset 0 1px 0 color-mix(in srgb, #ffffff 88%, transparent);
    font-size: var(--ts-font-sm);
}

.ts-attachment-toolbar .ts-attachment-filter.form-autocomplete:focus {
    border-color: var(--ts-primary);
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--ts-primary) 16%, transparent);
    outline: none;
}

.ts-activity-feed .msgbox-opened.ts-message-highlighted {
    box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--ts-success) 45%, transparent);
    background-color: color-mix(in srgb, var(--ts-success-soft) 35%, var(--ts-surface));
    border-radius: var(--ts-radius-sm);
}

@media (max-width: 980px) {
    .ts-task-layout {
        grid-template-columns: minmax(0, 1fr);
    }

    .ts-task-main,
    .ts-task-sidebar,
    .ts-task-layout__full {
        grid-column: 1;
    }

    .ts-attachment-toolbar {
        justify-content: flex-start;
    }

    .ts-attachment-toolbar__search {
        margin-left: 0;
        max-width: none;
        width: 100%;
    }

    .ts-attachment-toolbar__separator {
        display: none;
    }

    .ts-attachment-toolbar .ts-attachment-filter.form-autocomplete {
        min-width: 0;
    }

    .ts-workflow-toolbar__separator {
        display: none;
    }

    .ts-message-history-caption .ts-message-history-caption__search {
        width: 100%;
        min-width: 0;
    }

    .ts-activity-feed .ts-activity-item__header,
    .ts-activity-feed .ts-activity-item__header.ts-activity-item__header--with-checkbox {
        grid-template-columns: minmax(0, 1fr);
    }

    .ts-activity-feed .ts-activity-item__checkbox,
    .ts-activity-feed .ts-activity-item__header.ts-activity-item__header--with-checkbox .messagelabel.ts-activity-item__meta,
    .ts-activity-feed .ts-activity-item__header.ts-activity-item__header--with-checkbox .msgtime.ts-activity-item__time,
    .ts-activity-feed .msgtime.ts-activity-item__time,
    .ts-activity-feed .messagelabel.ts-activity-item__meta {
        grid-column: 1;
    }

    .ts-activity-feed .msgtime.ts-activity-item__time {
        justify-self: start;
    }
}

.taskinfo-right, .taskinfo-left {
    background-color: var(--ts-surface-muted) !important;
    font-weight: 600;
    font-size: var(--ts-font-base);
    border-bottom: 1px solid var(--ts-border);
    text-align: left;
}

div.taskDescription {
    margin-left: var(--ts-space-12);
    width: auto;
    max-width: 900px;
}
div.taskDescription.descclosed div.content {
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
}


/* ── User links ───────────────────────────────────────────── */

A.user {
    font-size: var(--ts-font-base);
    font-weight: 600;
    color: var(--ts-text);
}
SPAN.user {
    font-size: var(--ts-font-base);
    color: var(--ts-primary);
}
SPAN.user#loggedUser {
    color: var(--ts-success);
}

a.user.ts-user-with-avatar,
a.internal.ts-user-with-avatar,
span.user.ts-user-with-avatar,
div.user.ts-user-with-avatar {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    line-height: 1.3;
}

a.user.ts-user-with-avatar,
a.internal.ts-user-with-avatar {
    text-decoration: none;
}

span.user.ts-user-with-avatar img[src*="arw.usr"],
a.user.ts-user-with-avatar img[src*="arw.usr"],
a.internal.ts-user-with-avatar img[src*="arw.usr"],
div.user.ts-user-with-avatar img[src*="arw.usr"] {
    display: none !important;
}

.ts-user-avatar {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex: 0 0 auto;
    font-size: 10px;
    font-weight: 700;
    line-height: 1;
    text-transform: uppercase;
    color: #ffffff;
    background-color: var(--ts-user-avatar-bg, var(--ts-primary));
    box-shadow: inset 0 0 0 1px color-mix(in srgb, #000000 12%, transparent);
    margin-right: 6px;
}

a.user.ts-user-with-avatar .ts-user-avatar,
a.internal.ts-user-with-avatar .ts-user-avatar,
span.user.ts-user-with-avatar .ts-user-avatar,
div.user.ts-user-with-avatar .ts-user-avatar {
    margin-right: 0;
}


/* ── Internal links in lists ──────────────────────────────── */

a.internal {
    font-size: var(--ts-font-base);
    font-weight: 600;
    color: var(--ts-text);
    text-decoration: none;
}
a.internal:hover {
    color: var(--ts-primary);
}

span.ts-role-with-avatar,
a.ts-role-with-avatar,
div.ts-role-with-avatar,
label.ts-role-with-avatar {
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

a.ts-role-with-avatar {
    text-decoration: none;
}

.ts-role-avatar {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex: 0 0 auto;
    font-size: 10px;
    font-weight: 700;
    line-height: 1;
    text-transform: uppercase;
    color: var(--ts-role-avatar-bg, var(--ts-primary));
    background-color: var(--ts-surface);
    box-shadow: inset 0 0 0 1.5px var(--ts-role-avatar-bg, var(--ts-primary));
    margin-right: 6px;
}

span.ts-role-with-avatar .ts-role-avatar,
a.ts-role-with-avatar .ts-role-avatar,
div.ts-role-with-avatar .ts-role-avatar,
label.ts-role-with-avatar .ts-role-avatar {
    margin-right: 0;
}

span.ts-role-with-avatar img[src*="ico.status.gif"],
a.ts-role-with-avatar img[src*="ico.status.gif"],
div.ts-role-with-avatar img[src*="ico.status.gif"],
label.ts-role-with-avatar img[src*="ico.status.gif"],
td.ts-role-with-avatar img[src*="ico.status.gif"] {
    display: none !important;
}

a.copy_in_list       { color: #9b59b6; }
a.copy_recursively_in_list { color: #e67e22; }
a.cut_in_list        { color: #95a5a6; }

a.underline {
    font-size: var(--ts-font-base);
    text-decoration: underline;
}


/* ── Bookmarks panel ──────────────────────────────────────── */

div.bookmarkCaption {
    background-color: var(--ts-surface-muted);
    font-size: var(--ts-font-sm);
    color: var(--ts-text);
    font-weight: 600;
    border-bottom: 1px solid var(--ts-border);
    padding: var(--ts-space-1) var(--ts-space-2);
}

span.bookmarkName {
    font-size: var(--ts-font-sm);
    font-weight: 600;
}

div.bookmarkPanel {
    background-color: var(--ts-surface);
}


/* ── Allow/deny table ─────────────────────────────────────── */

TABLE.allowdeny CAPTION {
    color: var(--ts-primary-light);
    border-bottom: 1px solid var(--ts-border);
    font-weight: 600;
    font-size: var(--ts-font-base);
}
TABLE.allowdeny TH.allowed {
    background-color: var(--ts-success-soft);
}
TABLE.allowdeny TH.denied {
    background-color: var(--ts-danger-soft);
}


/* ── Miscellaneous overrides ──────────────────────────────── */

div.indent {
    padding: var(--ts-space-3) var(--ts-space-2);
}

div.blueborder {
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-sm);
    margin-bottom: var(--ts-space-3);
    box-shadow: none;
    background-color: var(--ts-surface);
    transition: box-shadow var(--ts-transition);
}
div.blueborder:hover {
    box-shadow: var(--ts-shadow-lg);
}

/* Inside blueborder, tables should not duplicate the outer border */
div.blueborder TABLE.general {
    border: none;
    border-radius: 0;
    box-shadow: none;
    margin-bottom: 0;
}

/* First table inside blueborder: no top border (caption or controlPanel provides it) */
div.blueborder div.indent > TABLE.general:first-child {
    border-top: none;
}

/* ── Task property table inside blueborder ────────────────── */

/* TH cells: transparent background, muted right-aligned labels */
div.blueborder TABLE.general TH {
    background-color: transparent;
    color: var(--ts-text-muted);
    font-weight: 500;
    border-bottom: 1px solid var(--ts-border);
}

/* Strut: transparent spacer, no borders */
div.blueborder TABLE.general TD.strut {
    width: 24px;
    padding: 0;
    background-color: transparent !important;
    border: none;
    border-bottom: none;
}

/* Section headers (.taskinfo-right / .taskinfo-left) */
div.blueborder .taskinfo-right,
div.blueborder .taskinfo-left {
    background-color: transparent !important;
    font-weight: 600;
    font-size: var(--ts-font-xs);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--ts-text-muted);
    border-bottom: 2px solid var(--ts-primary-light) !important;
    padding: var(--ts-space-2) var(--ts-space-3) var(--ts-space-1);
}

/* CAPTION for custom fields table */
div.blueborder TABLE.general CAPTION {
    background-color: transparent;
    border: none;
    border-top: 1px solid var(--ts-border);
    border-radius: 0;
    font-size: var(--ts-font-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--ts-text-muted);
    padding: var(--ts-space-3) var(--ts-space-3) var(--ts-space-1);
}

/* Empty/hidden TH labels — more muted */
div.blueborder TABLE.general TH.hden {
    opacity: 0.5;
}

hr {
    border: none;
    border-top: 1px solid var(--ts-border);
}

div.error {
    border: 1px solid var(--ts-danger);
    border-radius: var(--ts-radius-sm);
    color: var(--ts-text);
    padding: var(--ts-space-3);
}
div.errorTitle {
    color: var(--ts-danger);
    font-weight: 600;
}

cite {
    background-color: var(--ts-warning-soft);
}

/* ── Buttons (ts-btn) ─────────────────────────────────────── */

.ts-btn {
    appearance: none;
    border: 1px solid transparent;
    border-radius: var(--ts-radius-sm);
    padding: var(--ts-space-2) var(--ts-space-3);
    font-size: var(--ts-font-sm);
    font-weight: 600;
    line-height: 1.1;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    background-color: var(--ts-surface);
    color: var(--ts-text);
    transition: background-color var(--ts-transition), border-color var(--ts-transition), color var(--ts-transition), box-shadow var(--ts-transition);
}
.ts-btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--ts-primary-soft);
}
.ts-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}
.ts-btn--secondary {
    background-color: var(--ts-surface-muted);
    border-color: var(--ts-border);
}
.ts-btn--secondary:hover {
    background-color: var(--ts-surface);
    border-color: var(--ts-primary);
    color: var(--ts-primary);
}
.ts-btn--danger {
    background-color: var(--ts-danger-soft);
    border-color: var(--ts-danger);
    color: var(--ts-danger);
}
.ts-btn--danger:hover {
    background-color: var(--ts-danger-soft);
    background-color: color-mix(in srgb, var(--ts-danger) 14%, white);
}

.ts-btn--primary {
    background-color: var(--ts-accent);
    border-color: var(--ts-accent);
    color: #ffffff;
}

.ts-btn--primary:hover {
    background-color: var(--ts-accent-hover);
    border-color: var(--ts-accent-hover);
}

.ts-btn--success {
    background-color: var(--ts-success-soft);
    border-color: var(--ts-success);
    color: var(--ts-success);
}

.ts-btn--success:hover {
    background-color: color-mix(in srgb, var(--ts-success) 12%, white);
}

.ts-btn--outline {
    background-color: transparent;
    border-color: var(--ts-border-strong);
    color: var(--ts-text);
}

.ts-btn--outline:hover {
    border-color: var(--ts-primary);
    color: var(--ts-primary);
    background-color: var(--ts-primary-soft);
}

/* Legacy form controls: make all delete actions visually destructive */
input[type="submit"].iconized[name*="delete" i],
input[type="button"].iconized[name*="delete" i],
button.iconized[name*="delete" i] {
    background-color: var(--ts-danger-soft) !important;
    border: 1px solid var(--ts-danger) !important;
    color: var(--ts-danger) !important;
}
input[type="submit"].iconized[name*="delete" i]:hover,
input[type="button"].iconized[name*="delete" i]:hover,
button.iconized[name*="delete" i]:hover {
    background-color: var(--ts-danger-soft) !important;
    background-color: color-mix(in srgb, var(--ts-danger) 12%, white) !important;
    border-color: var(--ts-danger) !important;
    color: var(--ts-danger) !important;
}

/* ── Bulk bar ─────────────────────────────────────────────── */

.ts-bulk-bar {
    position: fixed;
    left: 50%;
    bottom: var(--ts-space-4);
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: var(--ts-space-3);
    padding: var(--ts-space-2) var(--ts-space-4);
    border: 1px solid var(--ts-border);
    border-radius: var(--ts-radius-lg);
    background-color: var(--ts-surface);
    box-shadow: var(--ts-shadow-lg);
    z-index: 1000;
    max-width: calc(100% - 32px);
    flex-wrap: wrap;
}
.ts-bulk-bar__count {
    font-size: var(--ts-font-sm);
    font-weight: 600;
    color: var(--ts-text);
}
.ts-bulk-bar__actions {
    display: inline-flex;
    align-items: center;
    gap: var(--ts-space-2);
}

/* Service panel (bulk selection bar) */
div#servicePanel, div.norm#servicePanel {
    background-color: var(--ts-warning-soft);
    border-top: 1px solid var(--ts-warning);
    border-bottom: 1px solid var(--ts-warning);
    font-size: var(--ts-font-base);
}

.ts-service-panel-item {
    padding-top: 1px;
    padding-bottom: 1px;
    font-family: Verdana, sans-serif;
    font-size: 11px;
    font-weight: 700;
}

/* Search results */
div.xfound, div.empty {
    background-color: var(--ts-warning-soft);
    border-radius: var(--ts-radius-sm);
    padding: var(--ts-space-3);
}

/* Generic controls area */
.controls {
    padding: var(--ts-space-2) 0;
}

/* Fullpath (alt breadcrumb) */
DIV.fullpath {
    font-size: var(--ts-font-sm);
    color: var(--ts-text-muted);
}
DIV.fullpath A {
    font-size: var(--ts-font-sm);
    color: var(--ts-text-muted);
    font-weight: 500;
}


/* ── Tree panel header (inside TreeFrame) ─────────────────── */

label.header {
    font-size: var(--ts-font-sm);
    font-weight: 600;
    padding: var(--ts-space-1) var(--ts-space-2);
    height: auto;
}


/* ── TSDialog — modal dialogs (replaces YUI Dialog) ───────── */

.ts-dialog-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.4);
    z-index: var(--ts-z-modal-backdrop);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--ts-transition);
}
.ts-dialog-overlay.visible {
    opacity: 1;
    pointer-events: auto;
}

.ts-dialog {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.95);
    background: var(--ts-surface);
    border-radius: var(--ts-radius-md);
    box-shadow: var(--ts-shadow-xl);
    z-index: var(--ts-z-modal);
    opacity: 0;
    pointer-events: none;
    transition: all var(--ts-transition);
    max-width: 90vw;
    max-height: 90vh;
    overflow: auto;
}
.ts-dialog.visible {
    opacity: 1;
    pointer-events: auto;
    transform: translate(-50%, -50%) scale(1);
}

/* YUI-compat: .hd = header, .bd = body, .ft = footer */
.ts-dialog .hd {
    padding: var(--ts-space-4) var(--ts-space-5) var(--ts-space-2);
    font-size: var(--ts-font-lg);
    font-weight: 600;
    color: var(--ts-text);
    border-bottom: none;
}

.ts-dialog .bd {
    padding: var(--ts-space-2) var(--ts-space-5) var(--ts-space-4);
    font-size: var(--ts-font-base);
    color: var(--ts-text);
    line-height: var(--ts-line-height);
}

.ts-dialog .bd table {
    width: 100%;
}
.ts-dialog .bd table td {
    padding: var(--ts-space-1) var(--ts-space-2) var(--ts-space-1) 0;
    vertical-align: middle;
}
.ts-dialog .bd table label {
    font-weight: 600;
    color: var(--ts-text-muted);
    white-space: nowrap;
}

/* Button footer */
.ts-dialog-buttons {
    display: flex;
    justify-content: flex-end;
    gap: var(--ts-space-2);
    padding: var(--ts-space-3) var(--ts-space-5) var(--ts-space-4);
    border-top: 1px solid var(--ts-border);
}

.ts-dialog-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: var(--ts-input-height);
    padding: var(--ts-space-1) var(--ts-space-5);
    border: 1px solid var(--ts-border-strong);
    border-radius: var(--ts-radius-sm);
    background-color: var(--ts-surface);
    color: var(--ts-text);
    font-family: var(--ts-font-family);
    font-size: var(--ts-font-base);
    font-weight: 500;
    cursor: pointer;
    transition: all var(--ts-transition);
    white-space: nowrap;
}
.ts-dialog-btn:hover {
    background-color: var(--ts-surface-muted);
    border-color: var(--ts-primary);
}

.ts-dialog-btn-primary {
    background-color: var(--ts-accent);
    border-color: var(--ts-accent);
    color: #0A1628;
    font-weight: 600;
}
.ts-dialog-btn-primary:hover {
    background-color: var(--ts-accent-hover);
    border-color: var(--ts-accent-hover);
}
.ts-dialog-btn-danger,
.ts-dialog-quick-danger .ts-dialog-btn-primary {
    background-color: var(--ts-danger);
    border-color: var(--ts-danger);
    color: #FFFFFF;
    font-weight: 600;
}
.ts-dialog-btn-danger:hover,
.ts-dialog-quick-danger .ts-dialog-btn-primary:hover {
    background-color: var(--ts-danger);
    border-color: var(--ts-danger);
    background-color: color-mix(in srgb, var(--ts-danger) 84%, black);
    border-color: color-mix(in srgb, var(--ts-danger) 84%, black);
}

/* Quick dialogs (confirm/alert) */
.ts-dialog-quick {
    width: 420px;
    min-width: 280px;
}
.ts-dialog-quick-body {
    padding: var(--ts-space-5);
    font-size: var(--ts-font-md);
    color: var(--ts-text);
    line-height: var(--ts-line-height);
}

/* Hide YUI-generated markup that may linger */
.yui-skin-sam .yui-panel-container,
.yui-skin-sam .mask {
    display: none !important;
}
